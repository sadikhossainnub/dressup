<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
    @media print {
        @page { size: A4 portrait; margin: 5mm; }
        .sketch-container { width: 100% !important; }
    }
    
    * {
        box-sizing: border-box;
        -webkit-print-color-adjust: exact;
    }
    :root {
        --primary: #000;
        --border-color: #000;
        --text-color: #000;
        --label-color: #000;
    }

    .sketch-container {
        font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        font-size: 9pt;
        color: var(--text-color);
        line-height: 1.3;
        width: 100%;
        background: #fff;
        margin: 0 auto;
    }

    /* Header */
    .header-section {
        display: block;
        width: 100%;
        margin-bottom: 20px;
        clear: both;
    }
    .header-logo {
        float: left;
        width: 50%;
    }
    .header-logo img {
        height: 60px;
    }
    .header-address {
        float: right;
        width: 50%;
        text-align: right;
        font-size: 8pt;
        line-height: 1.4;
    }

    /* Title Bar */
    .title-bar {
        display: block;
        width: 100%;
        margin-bottom: 5px;
        padding-bottom: 5px;
        clear: both;
    }
    .doc-title {
        float: left;
        font-size: 14pt;
        font-weight: 700;
        text-transform: uppercase;
    }
    .doc-meta {
        float: right;
        text-align: right;
        font-weight: 600;
        font-size: 9pt;
    }

    /* Top Info Box */
    .info-box {
        border: 1px solid var(--border-color);
        display: block;
        width: 100%;
        margin-bottom: 10px;
        clear: both;
        overflow: hidden;
    }
    .info-col {
        float: left;
        width: 50%;
        padding: 5px 8px;
        box-sizing: border-box;
    }
    .info-col:first-child {
        border-right: 1px solid var(--border-color);
    }
    .info-row {
        margin-bottom: 2px;
    }
    .label {
        font-weight: 700;
    }

    /* Main Grid Layout */
    .main-grid {
        display: block;
        width: 100%;
        clear: both;
        overflow: hidden;
    }
    .left-panel {
        float: left;
        width: 38%;
        margin-right: 2%;
    }
    .right-panel {
        float: left;
        width: 60%;
    }

    /* Sections */
    .section-box {
        border: 1px solid var(--border-color);
        padding: 8px;
        font-size: 8.5pt;
        margin-bottom: 10px;
        width: 100%;
        box-sizing: border-box;
    }
    .section-header {
        font-weight: 700;
        margin-bottom: 5px;
        text-decoration: underline;
    }
    
    /* Tables in sections */
    .spec-table {
        width: 100%;
        border-collapse: collapse;
    }
    .spec-table td {
        padding: 1px 0;
        vertical-align: top;
    }
    .spec-table .val {
        text-align: right;
        font-weight: 600;
    }

    .cost-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 5px;
    }
    .cost-table td {
        padding: 1px 0;
    }
    .cost-table .cost-val {
        text-align: right;
    }

    /* Image */
    .design-image-container {
        width: 100%;
        min-height: 400px;
        border: 1px solid transparent; 
        display: block;
        background: #fdfdfd;
        text-align: center;
    }
    .design-image {
        max-width: 100%;
        height: auto;
        display: block;
        margin: 0 auto;
    }
    
    /* Footer */
    .footer-box {
        border: 1px solid var(--border-color);
        padding: 5px 8px;
        margin-top: 10px;
        min-height: 30px;
    }

</style>

<div class="sketch-container">

    <!-- Header -->
    <div class="header-section">
        <div class="header-logo">
             <img src="{{ frappe.utils.get_url() }}/files/Capture.PNG" alt="DressUp">
        </div>
        <div class="header-address">
            House # 5, Road # 6<br>
            Kollyanpur, Dhaka<br>
            +8809678247247<br>
            support@dressup.com.bd<br>
            dressupbangladesh <i class="fa fa-facebook-square"></i><br>
            www.dressup.com.bd
        </div>
    </div>

    <!-- Title Bar -->
    <div class="title-bar">
        <div class="doc-title">SKETCH SPECIFICATION SHEET</div>
        <div class="doc-meta">
            <div>DOC ID: {{ doc.name }}</div>
            <div>Date: {{ frappe.utils.formatdate(doc.creation) }}</div>
        </div>
    </div>

    <!-- Info Box -->
    <div class="info-box">
        <div class="info-col">
            <div class="info-row"><span class="label">Tech Pack No:</span> {{ doc.name }}</div>
            <div class="info-row"><span class="label">Designer Name:</span> {{ doc.designer_name }}</div>
            <div class="info-row"><span class="label">Design No:</span> {{ doc.design_no }}</div>
            <div class="info-row"><span class="label">Category:</span> {{ doc.category }}</div>
            <div class="info-row"><span class="label">Season:</span> {{ doc.seson }}</div>
            <div class="info-row"><span class="label">Sewing Finish:</span> {{ doc.sewing_finish }}</div>
        </div>
        <div class="info-col">
            <div class="info-row"><span class="label">Start Date:</span> {{ frappe.utils.formatdate(doc.start_date) if doc.start_date else '' }}</div>
            <div class="info-row"><span class="label">Item Name:</span> {{ doc.item_name }}</div>
            <div class="info-row"><span class="label">Cut/ Fit Style:</span> {{ doc.cut_fit_style }}</div>
            <div class="info-row"><span class="label">Collar/ Neck Style:</span> {{ doc.collar_neck_style }}</div>
            <div class="info-row"><span class="label">Side Cut:</span> {{ doc.side_cut }}</div>
            <div class="info-row"><span class="label">Submission Date:</span> {{ frappe.utils.formatdate(doc.submission_date) if doc.submission_date else '' }}</div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-grid">
        
        <!-- Left Column -->
        <div class="left-panel">
            
            <!-- Body Measurements -->
            <!-- Body Measurements Logic -->
            {% set measurement_items = [] %}
            {% set m_defs = [
                ('full_length', 'Length / দৈর্ঘ্য'),
                ('high_hip', 'High Hip / উচ্চ হিপ'),
                ('front_neck_depth_s', 'Collar Width / কলারের প্রস্থ'),
                ('back_neck_depth_s', 'Collar Height / কলারের উচ্চতা'),
                ('bust', 'Bust / বক্ষ'),
                ('waist_circumstance', 'Waist / কোমর'),
                ('shoulder', 'Shoulder'),
                ('armhole', 'Armhole'),
                ('sleevelength', 'Sleeve Length'),
                ('cuff_opening', 'Cuff Opening')
            ] %}
            {% for f, l in m_defs %}
                {% if doc.get(f) %}
                    {% set _ = measurement_items.append((l, doc.get(f))) %}
                {% endif %}
            {% endfor %}
            
            {% if measurement_items %}
            <div class="section-box" style="border:none; padding:0;">
                 <div class="section-header">Body Measurements:</div>
                 <table class="spec-table">
                    {% for label, val in measurement_items %}
                    <tr>
                        <td>{{ label }}</td>
                        <td class="val">{{ val }}</td>
                    </tr>
                    {% endfor %}
                 </table>
            </div>
            {% endif %}

            <!-- Bottom Specs Logic -->
            {% set bottom_items = [] %}
            {% set b_defs = [
                ('length_bottom', 'Length / দৈর্ঘ্য'),
                ('high_hip', 'High Hip / উচ্চ হিপ'),
                ('low_hip', 'Low Hip'),
                ('thigh_uru', 'Thigh'),
                ('knee_x2', 'Knee'),
                ('leg_opening_x2', 'Leg Opening')
            ] %}
            {% for f, l in b_defs %}
                {% if doc.get(f) %}
                    {% set _ = bottom_items.append((l, doc.get(f))) %}
                {% endif %}
            {% endfor %}

            {% if bottom_items %}
            <div class="section-box" style="border:none; padding:0; margin-top:5px;">
                 <div class="section-header">Bottom Specifications / নিচের মাপসমূহ</div>
                 <table class="spec-table">
                    {% for label, val in bottom_items %}
                    <tr>
                        <td>{{ label }}</td>
                        <td class="val">{{ val }}</td>
                    </tr>
                    {% endfor %}
                 </table>
            </div>
            {% endif %}

            <!-- Workstations Summary -->
            {% set ws_list = [] %}
            {% if doc.cutting %}{% set _ = ws_list.append('Cutting') %}{% endif %}
            {% if doc.sewing %}{% set _ = ws_list.append('Sewing') %}{% endif %}
            {% if doc.sp %}{% set _ = ws_list.append('Screen Print') %}{% endif %}
            {% if doc.hand_embroidery %}{% set _ = ws_list.append('Hand Embroidery') %}{% endif %}
            {% if doc.karchupi %}{% set _ = ws_list.append('Karchupi') %}{% endif %}
            {% if doc.bp %}{% set _ = ws_list.append('Block Print') %}{% endif %}
            {% if doc.td %}{% set _ = ws_list.append('Tie Dye') %}{% endif %}
            
            {% if ws_list %}
            <div class="section-box">
                <div class="section-header">Workstations:</div>
                <div>{{ ws_list|join(', ') }}</div>
            </div>
            {% endif %}

            <!-- Screen Print Box -->
            {% if doc.sp %}
            <div class="section-box">
                <div class="section-header">Workstation - Screen Print:</div>
                <div class="info-row">Old Frame / SKU# {{ doc.old_frame__sku or '' }}, New Frame / SKU# {{ doc.new_frame__sku or '' }}</div>
                <div class="info-row">Color Units # {{ doc.color_units }}</div>
                
                <!-- Colors -->
                {% set sp_colors = [] %}
                {% if doc.color %}{% set _ = sp_colors.append(doc.color) %}{% endif %}
                {% if doc.color_2 %}{% set _ = sp_colors.append(doc.color_2) %}{% endif %}
                {% if doc.color_3 %}{% set _ = sp_colors.append(doc.color_3) %}{% endif %}
                {% if doc.color_4 %}{% set _ = sp_colors.append(doc.color_4) %}{% endif %}
                
                <div class="info-row" style="margin: 5px 0;">
                    <strong>{{ sp_colors|join(', ') }}</strong>
                </div>

                <!-- Cost Table -->
                <table class="cost-table">
                    <tr><td>Cost for 30 Unit</td><td class="cost-val">{{ doc.cost_for_30_unit or '' }}</td></tr>
                    <tr><td>Cost for 50 Unit</td><td class="cost-val">{{ doc.cost_for_50_unit or '' }}</td></tr>
                    <tr><td>Cost for 70 Unit</td><td class="cost-val">{{ doc.cost_for_70_unit or '' }}</td></tr>
                    <tr><td>Cost for 100 Unit</td><td class="cost-val">{{ doc.cost_for_100_unit or '' }}</td></tr>
                    <tr><td>Cost for 150 Unit</td><td class="cost-val">{{ doc.cost_for_150_unit or '' }} <!-- Assuming field exists, or use generic logic --></td></tr>
                </table>
            </div>
            {% endif %}

            <!-- Hand Embroidery Box -->
            {% if doc.hand_embroidery %}
            <div class="section-box">
                <div class="section-header">Workstation - Hand Embroidery</div>
                <div class="info-row">Color Threads # 3</div> <!-- Static or dynamic? Using static based on image, or add logic if field exists -->
                <div class="info-row" style="margin: 5px 0;">
                    <strong>#29CD42, #CB2929, #ED6396</strong> <!-- Needs dynamic color logic if available -->
                </div>
                <!-- Calculate rate if available -->
                 <table class="cost-table">
                    <tr><td>Cost per Unit</td><td class="cost-val">{{ doc.rate or '' }}</td></tr>
                </table>
                <div class="info-row" style="margin-top: 5px;">
                    Proposed Producer: {{ doc.hand_embroider or '' }}
                    {% if doc.sample %}({{ doc.sample }}){% endif %}
                </div>
            </div>
            {% endif %}

        </div>

        <!-- Right Column (Image) -->
        <div class="right-panel">
            <div class="design-image-container">
                {% if doc.image %}
                    <img src="{{ frappe.utils.get_url(doc.image) }}" class="design-image">
                {% elif doc.additional_images and doc.additional_images[0] %}
                     <img src="{{ frappe.utils.get_url(doc.additional_images[0].image) }}" class="design-image">
                {% else %}
                    <div style="padding: 100px; color: #ccc;">No Main Image Selected</div>
                {% endif %}
            </div>
        </div>

    </div>

    <!-- Footer Note -->
    <div class="footer-box">
        <strong>Note:</strong> {{ doc.text_editor_noaa or '' }}
    </div>

</div>
