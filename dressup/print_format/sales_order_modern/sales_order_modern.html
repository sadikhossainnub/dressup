<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <style>
        :root {
            --primary: #0f172a;
            --accent: #2563eb;
            --text-main: #1e293b;
            --text-light: #64748b;
            --border-color: #e2e8f0;
            --bg-muted: #f8fafc;
        }

        @media print {
            @page {
                size: A4 portrait;
                margin: 7mm;
            }
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            .no-print { display: none; }
        }

        body { 
            font-family: 'Inter', 'Segoe UI', Roboto, sans-serif; 
            color: var(--text-main); 
            line-height: 1.2; 
            margin: 0; 
            padding: 0;
            background-color: #fff;
            font-size: 8.5pt;
        }

        .print-format-container {
            width: 100%;
            margin: 0;
            padding: 0;
        }

        .header { 
            display: flex; 
            justify-content: space-between; 
            align-items: flex-start;
            border-bottom: 2pt solid var(--primary); 
            padding-bottom: 8px; 
            margin-bottom: 12px; 
        }

        .brand-logo { 
            font-size: 20px; 
            font-weight: 900; 
            color: var(--primary); 
            text-transform: uppercase;
            line-height: 1;
        }
        
        .company-address {
            font-size: 8pt;
            margin-top: 4px;
            color: var(--text-light);
            max-width: 350px;
            line-height: 1.2;
        }

        .doc-type { text-align: right; }
        .doc-type h1 { 
            margin: 0; 
            font-size: 20px; 
            font-weight: 800;
            text-transform: uppercase; 
            letter-spacing: 0.5px;
            line-height: 1;
        }
        .doc-id { 
            color: var(--accent); 
            font-weight: 700; 
            font-size: 10pt;
            margin-top: 2px;
        }
        
        .stamp { 
            border: 1.5pt solid #10b981; 
            color: #10b981; 
            padding: 2px 8px; 
            text-transform: uppercase; 
            font-weight: 800; 
            font-size: 9pt;
            border-radius: 4px; 
            display: inline-block; 
            margin-top: 5px;
            transform: rotate(-5deg); 
        }

        .info-grid { 
            display: grid; 
            grid-template-columns: 1.2fr 0.8fr; 
            gap: 20px; 
            margin-bottom: 15px; 
        }

        .section-title { 
            font-size: 7.5pt; 
            text-transform: uppercase; 
            font-weight: 800; 
            color: var(--text-light); 
            margin-bottom: 4px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 2px;
        }

        .meta-table { width: 100%; border-collapse: collapse; }
        .meta-table td { padding: 2px 0; }
        .meta-label { color: var(--text-light); font-weight: 600; }

        .items-table { 
            width: 100%; 
            border-collapse: collapse; 
            margin: 10px 0; 
        }
        .items-table th { 
            background: var(--bg-muted); 
            text-align: left; 
            padding: 6px 8px; 
            font-size: 8pt; 
            text-transform: uppercase; 
            border-top: 1pt solid var(--primary);
            border-bottom: 1pt solid var(--primary);
            font-weight: 800;
        }
        .items-table td { 
            padding: 5px 8px; 
            border-bottom: 1px solid var(--border-color); 
            vertical-align: top;
        }

        .summary-wrapper { 
            display: flex; 
            justify-content: flex-end; 
            margin-top: 10px;
        }
        .summary-table { 
            width: 240px; 
            border-collapse: collapse; 
        }
        .summary-table td { 
            padding: 4px 8px; 
        }
        .summary-label { font-weight: 600; color: var(--text-light); }
        
        .total-row { 
            background: var(--primary); 
            color: white; 
            font-weight: 800; 
            font-size: 10pt;
        }

        .footer { 
            margin-top: 25px; 
            display: flex; 
            justify-content: space-between; 
            font-size: 8pt; 
        }
        
        .notes-section { max-width: 65%; }
        
        .signature-box { 
            text-align: center; 
            border-top: 1pt solid var(--primary); 
            padding-top: 4px; 
            width: 140px; 
            font-weight: 700;
            text-transform: uppercase;
            font-size: 7.5pt;
        }

        .bottom-bar {
            text-align: center;
            font-size: 7pt;
            color: var(--text-light);
            margin-top: 30px;
            border-top: 1px dashed var(--border-color);
            padding-top: 8px;
        }
    </style>
</head>
<body>
    <div class="print-format-container">
        <div class="header">
            <div>
                <div class="brand-logo">{{ doc.company }}</div>
                <div class="company-address">{{ doc.company_address_display or '' }}</div>
            </div>
            <div class="doc-type">
                <h1>Sales Order</h1>
                <div class="doc-id">{{ doc.name }}</div>
                {% if doc.status == "Completed" %}
                    <div class="stamp">COMPLETED / সম্পন্ন</div>
                {% elif doc.status == "Draft" %}
                    <div class="stamp" style="border-color: var(--text-light); color: var(--text-light);">DRAFT</div>
                {% endif %}
            </div>
        </div>

        <div class="info-grid">
            <div>
                <div class="section-title">Customer Details / গ্রাহকের তথ্য</div>
                <div style="padding-left: 2px;">
                    <strong style="font-size: 10pt;">{{ doc.customer_name }}</strong><br>
                    <div style="color: var(--text-main); line-height: 1.3;">
                        {{ doc.address_display or '' }}
                    </div>
                    {% if doc.contact_display %}
                        <div style="font-size: 8pt; margin-top: 3px; color: var(--text-light);">
                            {{ doc.contact_display }}
                        </div>
                    {% endif %}
                </div>
            </div>
            <div>
                <div class="section-title">Order Details / অর্ডারের বিবরণ</div>
                <table class="meta-table">
                    <tr>
                        <td class="meta-label">Date / তারিখ</td>
                        <td style="text-align:right"><strong>{{ doc.get_formatted("transaction_date") }}</strong></td>
                    </tr>
                    <tr>
                        <td class="meta-label">Delivery Date / ডেলিভারি তারিখ</td>
                        <td style="text-align:right">{{ doc.get_formatted("delivery_date") }}</td>
                    </tr>
                    {% if doc.po_no %}
                    <tr>
                        <td class="meta-label">PO Ref / পিও রেফারেন্স</td>
                        <td style="text-align:right">{{ doc.po_no }}</td>
                    </tr>
                    {% endif %}
                    {% if doc.project %}
                    <tr>
                        <td class="meta-label">Project / প্রকল্প</td>
                        <td style="text-align:right">{{ doc.project }}</td>
                    </tr>
                    {% endif %}
                </table>
            </div>
        </div>

        <table class="items-table">
            <thead>
                <tr>
                    <th style="width: 45%;">Item Description / পণ্যের বিবরণ</th>
                    <th style="text-align:center; width: 15%;">Qty / পঃ</th>
                    <th style="text-align:right; width: 20%;">Rate / দর</th>
                    <th style="text-align:right; width: 20%;">Amount / মোট</th>
                </tr>
            </thead>
            <tbody>
                {% for item in doc.items %}
                <tr>
                    <td>
                        <div style="font-weight: 700;">{{ item.item_name }}</div>
                        {% if item.description and item.description != item.item_name %}
                            <div style="font-size: 7.5pt; color: var(--text-light); line-height: 1.1; margin-top: 2px;">
                                {{ item.description }}
                            </div>
                        {% endif %}
                    </td>
                    <td style="text-align:center">{{ item.qty }} <small>{{ item.uom }}</small></td>
                    <td style="text-align:right">{{ doc.get_formatted("rate", item) }}</td>
                    <td style="text-align:right; font-weight: 600;">{{ doc.get_formatted("amount", item) }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <div class="summary-wrapper">
            <table class="summary-table">
                <tr>
                    <td class="summary-label">Subtotal / উপকুল</td>
                    <td style="text-align:right">{{ doc.get_formatted("total") }}</td>
                </tr>
                {% if doc.discount_amount %}
                <tr>
                    <td class="summary-label">Discount / ডিসকাউন্ট</td>
                    <td style="text-align:right">-{{ doc.get_formatted("discount_amount") }}</td>
                </tr>
                {% endif %}
                {% for tax in doc.taxes %}
                    {% if tax.tax_amount %}
                    <tr>
                        <td class="summary-label">{{ tax.description or tax.account_head }}</td>
                        <td style="text-align:right">{{ doc.get_formatted("tax_amount", tax) }}</td>
                    </tr>
                    {% endif %}
                {% endfor %}
                <tr class="total-row">
                    <td>GRAND TOTAL / সর্বমোট</td>
                    <td style="text-align:right">{{ doc.get_formatted("grand_total") }}</td>
                </tr>
                {% if doc.advance_paid %}
                <tr>
                    <td class="summary-label">Advance / অগ্রিম</td>
                    <td style="text-align:right">{{ doc.get_formatted("advance_paid") }}</td>
                </tr>
                {% endif %}
            </table>
        </div>

        <div style="margin-top: 5px; font-size: 8pt;">
            <strong>Amount in words:</strong> <em>{{ doc.in_words }}</em>
        </div>

        <div class="footer">
            <div class="notes-section">
                <div class="section-title">Terms & Notes / শর্তাবলী</div>
                <div style="line-height: 1.3; white-space: pre-line;">{{ doc.terms or 'Thank you for your order.' }}</div>
            </div>
            <div style="display: flex; align-items: flex-end;">
                <div class="signature-box">
                    Authorized Signatory
                </div>
            </div>
        </div>

        <div class="bottom-bar">
            This is a computer-generated order acknowledgement and does not require a physical signature.
            <br>
            <strong>{{ doc.company }}</strong> &copy; {{ frappe.utils.now_datetime().year }}
        </div>
    </div>
</body>
</html>
